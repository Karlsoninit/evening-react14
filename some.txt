import React, { Component, createRef } from 'react';

class DropDownComponent extends Component {
  backdropRef = createRef();

  state = {
    isOpen: true,
  };

  componentDidMount() {
    window.addEventListener('keydown', this.handleKeyPress);
  }

  componentWillUnmount() {
    window.addEventListener('keydown', this.handleKeyPress);
  }
  handleKeyPress = e => {
    // console.log(e.code);
    if (e.code !== 'Escape') return;
    this.onClose();
  };

  onClose = () => {
    this.setState({
      isOpen: false,
    });
  };

  handleClick = () => {
    this.setState(({ isOpen }) => ({
      isOpen: !isOpen,
    }));
  };

  handlePress = e => {
    console.log(e.target);
    const { current } = this.backdropRef;
    console.log(current);
    if (e.target === current) {
      this.onClose();
    }
  };

  backDrop = () => {};
  render() {
    const { isOpen } = this.state;
    return (
      <>
        <button onClick={this.handleClick}>Open</button>
        {isOpen && (
          <div
            onClick={this.handlePress}
            ref={this.backdropRef}
            style={{
              width: '400px',
              height: '400px',
              border: '1px solid red',
              margin: 'auto',
            }}
          >
            <p>Some text</p>
          </div>
        )}
      </>
    );
  }
}

export default DropDownComponent;
